# Behavioral Trap, Perturbation Trigger: Integrated Adversarial Scenarios for Autonomous Driving

## Visualize Scenario

```
safety-critical scenarios/
│
├── scenario1
    ├── RAW.gif
    ├── PGD.GIF
    ├── CAT.GIF
    ├── PDIAG.gif
├── scenario2
├── scenario3
├── ......
```

Each scenario includes the following visualizations:

- **RAW.gif**: Baseline replay of the original, unmodified scenario.

- **PGD.gif**: Digital adversarial attack generate safety-critical scenario.

- **CAT.gif**: Physical adversarial attack generate safety-critical scenario.

- **PDIAG.gif**: Safety-critical scenario generated via the **PDIAG** method.

  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario1/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario1/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario1/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario1/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario2/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario2/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario2/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario2/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario3/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario3/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario3/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario3/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario4/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario4/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario4/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario4/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario5/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario5/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario5/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario5/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario6/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario6/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario6/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario6/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario7/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario7/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario7/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario7/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario8/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario8/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario8/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario8/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario9/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario9/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario9/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario9/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario10/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario10/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario10/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario10/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario11/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario11/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario11/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario11/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario12/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario12/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario12/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario12/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>
  
  <table align="center">
  <tr>
    <td align="center"><img src="./safety-critical scenarios/scenario13/RAW.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario13/PDIAG.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario13/PGD.gif" width="100%"></td>
    <td align="center"><img src="./safety-critical scenarios/scenario13/CAT.gif" width="100%"></td>
  </tr>
  <tr>
    <td align="center">RAW</td>
    <td align="center">PDIAG (Ours)</td>
    <td align="center">PGD</td>
    <td align="center">CAT</td>
  </tr>
  </table>

## Data Preparation

Download the pre-trained trajectory prediction model DenseTNT and pre-trained adversarial policy which is used in Perturbation Trigger phase of PDIAG in https://drive.google.com/drive/folders/10Ns2Fd5SfV7DLJE79lrpSNXtgncrUhPV?usp=sharing